import e from"debug";import t from"fs";import r from"node:path";import{readdirSync as n}from"node:fs";e("@foo-dog:utils");function o(e){return".pug"==e.toLowerCase()||".foo-dog"==e.toLowerCase()}function s(e){try{return t.accessSync(e),!0}catch(e){return!1}}function i(){const e=process.cwd();let r=!0;for(;r;)try{t.accessSync("package.json",t.constants.F_OK),r=!1}catch(e){process.chdir("..")}const n=process.cwd();return process.chdir(e),n}Array.prototype.peek=function(){return this[this.length-1]},String.prototype.removeFromEnd=function(e){return this.endsWith(e)?this.substring(0,this.lastIndexOf(e)):this.toString()};const a=e("@foo-dog/utils:parse_arguments");function c(e,t){e.forEach((e=>{!function(e,t){const r=function(e){let t=[e.name];e.aliases&&(t=t.concat(e.aliases));return t}(e);if(!function(e,t){return l(e,t.args)||l(e,t.options)}(r,t))throw new Error('Required field "'+e.name+'" was not found')}(e,t)}))}function l(e,t){let r=!1;if(a("nameAndAliases=",e),a("parameterCollection=",t),null!=t)if(Array.isArray(t)&&t.length)r=e.some((e=>t.includes(e)));else{if("object"!=typeof t)throw console.error("Unexpected error in checkCollectionForNameOrAlias(). nameAndAliases=",e,", parameterCollection=",t),new Error("Unexpected error (and nothing coded to handle it)");r=e.some((e=>t.hasOwnProperty(e)))}return r}var u=async function(e,t,r){null==r&&(r="object"==typeof t?t:{});const n=r.optional??[],o=r.required??[];a("optional parameters=",n),a("required parameters=",o);const s={};let i;if(!function(e){return a("processOrArgv=",e),"object"==typeof e&&e.hasOwnProperty("argv")&&e.argv[0].startsWith("/")&&e.title.endsWith("node")}(e)?i=(null==e?void 0:e.argv)||e:(s.nodePath=e.argv[0],s.program=e.argv[1],i=e.argv.slice(2)),!i.includes("-h")&&!i.includes("--help")){const e={},t=[];return i.forEach((r=>{if("-"===r)t.push(r);else if(r.startsWith("--")){const[t,n]=r.split("=");e[t.slice(2)]=n||!0}else if(r.startsWith("-")){const[t,n]=r.split("=");e[t.slice(1)]=n||!0}else t.push(r)})),t.length>0&&(s.args=t),Object.keys(e).length>0&&(s.options=e),c(o,s),s}null!=t&&"function"==typeof t?t():a("No help available. Please contact the developer, which is probably Adam Koch, and tell him he is missing the help.")};function d(e,n,o){var s;if(null===(s=e[n])||void 0===s?void 0:s.name){var i,a,c;const s=r.resolve(e[n].name);!function(e){try{return!!t.statSync(e).isDirectory()&&(t.accessSync(e,t.constants.R_OK|t.constants.W_OK),!0)}catch(t){if("ENOTDIR"===t.code||"ENOENT"===t.code)return!1;throw console.error("Error testing if "+e+" is a directory. Error: "+t.message),t}}(s)?(e[n].isDir=()=>!1,"in"===n&&(e[n].createStream=function(e){try{return t.statSync(e),()=>t.createReadStream(e)}catch(t){if(t.message=="ENOENT: no such file or directory, stat '"+e+"'")return()=>{throw new Error("file not found")};throw t}}(s))):(e[n].isDir=()=>!0,o(e)),e[n].name="stdin"===(null===(i=e[n])||void 0===i?void 0:i.name)||"stdout"===(null===(a=e[n])||void 0===a?void 0:a.name)?null===(c=e[n])||void 0===c?void 0:c.name:s}}var f={withCreateStreams:e=>(d(e,"in",(function(e){e.in.files=n(e.in.name)})),d(e,"out",(function(e){const n=r.resolve(e.out.name);e.out.name=r.resolve(n,r.parse(e.in.name).name);try{t.statSync(e.out.name),e.out.createStream=()=>t.createWriteStream(e.out.name)}catch(t){if(console.error("Could not find directory: "+n+" or write "+e.out.name+": "+t.message),t.message=="ENOENT: no such file or directory, stat '"+n+"'")return()=>{throw new Error("file not found")};throw t}})),e)};function h(e){return null!=e&&null!=e}function m(e,t){return h(e)&&h(e[t])&&Array.isArray(e[t])?e[t].length:-1}function p(e){return m(e,"args")>1?e.args[1]:"stdout"}const g=async(...e)=>{const t=await u(...e),r={...t};var n;return r.in={name:(n=t,m(n,"args")>0?n.args[0]:"stdin")},r.out={name:p(t)},f.withCreateStreams(r)};export{g as parseArguments,s as exists,o as isSupportedFileExtension,i as simpleProjectRootDir};
//# sourceMappingURL=index.js.map
